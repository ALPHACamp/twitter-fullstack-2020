{{>left-sidebar route='tweets'}}
<div class="col-8">
  <div class="row d-flex justify-content-start">
    {{!-- header --}}
    <div class="col-8 ms-3" style="outline: 1px solid #E6ECF0;">
      {{!-- tittle --}}
      <div class="row">
        <button class="btn d-flex my-2" type="button" onclick="javascript:history.back()">
          <h4 class="navbar-brand mb-0">← 推文</h4>
        </button>
        <hr>
      </div>
      {{!-- tweet --}}
      <div class="row mt-2">
        <div class="col-2 ms-1" style="width: 60px;">
          <img src="{{tweet.User.avatar}}" alt="avatar" style="height: 50px ;width: 50px; border-radius: 50px;">
        </div>
        <div class="col-5">
          <p style="font-size: 16px; margin: 0 0;">{{tweet.User.name}}</p>
          <p style="font-size: 14px; margin: 0 0; color: #6C757D;">@{{tweet.User.account}}</p>
        </div>
        <div class="mt-2">
          <p style="font-size: 24px;">{{tweet.description}}</p>
          <p style="font-size: 14px;">{{time tweet.createdAt}}</p>
        </div>
        <hr>
        <div class="d-flex">
          <p>{{data.replyCount}} 回覆</p>
          <p class="ms-3">{{data.likeCount}} 喜歡次數</p>
        </div>
        <hr>
        <div class="d-flex mb-3">
          <i class="far fa-comment mx-3 d-flex align-items-center " data-bs-toggle="modal" data-bs-target="#replyModal"></i>
          {{#if data.isLiked}}
          <form action="/tweets/{{tweet.id}}/unlike" method="post">
            <button type="submit" style=" border: transparent; background: transparent;">
              <i class="fa-solid fa-heart ms-5" style="color: #E0245E;"></i>
            </button>
          </form>
          {{else}}
          <form action="/tweets/{{tweet.id}}/like" method="post">
            <button type="submit" style=" border: transparent; background: transparent;">
              <i class="far fa-heart ms-5"></i>
            </button>
          </form>
          {{/if}}
        </div>
        <hr>
      </div>
      {{!-- reply --}}
      {{#each data.replies}}
      <div class="row mt-3">
        <a href="/users/{{this.User.id}}" class="col-2 ms-1" style="width: 60px;">
          <img src="{{this.User.avatar}}" alt="avatar" style="height: 50px ;width: 50px; border-radius: 50px;">
        </a>
        <div class="col-10">
          <div class="d-flex flex-row align-items-center">
            <p style="font-size: 16px; margin: 0 0;">{{this.User.name}}</p>
            <p style="font-size: 14px; margin: 0 8px; color: #6C757D;">@{{this.User.account}}．{{relativeTimeFromNow this.createdAt}}</p>
          </div>
          <p class="mt-2" style="font-size: 14px; color: #6C757D;">回覆
            <span style="color:#FF6600;text-decoration: none">@{{../tweet.User.account}}</span>
          </p>
          <div class="mt-2">
            <p>{{this.comment}}</p>
          </div>
          <div>
            <i class="far fa-comment me-3">
              <span class="ms-2">666</span>
            </i>
            <i class="far fa-heart mx-3">
              <span class="ms-2">777</span>
            </i>
          </div>
        </div>
        <hr class="mb-0 mt-3">
      </div>
      {{/each}}
    </div>

    {{!-- right-sidebar 追隨者Top10的使用者 --}}
    <div class="container col-3 mt-2 mx-3" style="padding: 0 0;width: 250px; position: fixed; top: 0px; right: 100px;">
      <div class="bg-light" style="border-radius: 15px;">
        <div class="container d-flex align-items-center mt-3">
          <h4 class="fw-bold mt-4">跟隨誰</h4>
        </div>
        <div class="mt-3" style="height: 1px; width: auto; border-radius: 0px; background: #E6ECF0;"></div>
        {{#each users}}
        <div class="d-flex flex-row align-items-center ms-3 py-2">
          <a href="/users/{{this.id}}" class="d-flex align-items-center mx-0">
            <img src="{{this.avatar}}" alt="avatar" style="height: 40px ;width: 40px; border-radius: 50px;">
          </a>
          <div class="mx-2">
            <a href="/users/{{this.id}}" class="fw-bold" style="font-size: 16px; margin: 0 0;">{{this.name}}</a>
            <p class="text-muted" style="font-size: 14px; margin: 0 0;">{{this.account}}</p>
          </div>
          <div class="d-flex align-items-center">
            {{#if this.isFollowed}}
            <form action="/followships/{{this.id}}?_method=DELETE" method="POST" style="display: contents;">
              <button type="submit" class="following-button text-white">正在跟隨</button>
            </form>
            {{else}}
            <form action="/followships" method="POST" style="display: contents;">
              <button type="submit" class="follower-button ms-3" name="id" value="{{this.id}}">跟隨</button>
            </form>
            {{/if}}
          </div>
        </div>
        {{/each}}
      </div>
    </div>
  </div>

  {{!-- tweets modal --}}
  <form action="/tweets" method="POST">
    <div class="modal fade" id="tweetModal" tabindex="-1" aria-labelledby="tweetModalLabel" aria-hidden="true">
      <div class="modal-dialog" style="max-width: 600px">
        <div class="modal-content" style="border-radius: 15px">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            style="margin: 15px 0px 0px 15px;"></button>
          <hr>
          <div class="row" style="">
            <div class="col-2 ms-3" style="width: 60px;">
              <img src="{{user.avatar}}" alt="avatar" style="height: 50px ;width: 50px; border-radius: 50%;">
            </div>
            <div class="col-9 mb-3 ">
              <textarea class="form-control" id="description" name="description" rows="5" placeholder="有什麼新鮮事？"
                style="width: 480px; border: none; background-color: white; word-wrap: break-word;"></textarea>
            </div>
          </div>
          <div class="d-flex flex-row-reverse me-3 mb-3">
            <button type="submit" class="btn btn-primary" data-bs-dismiss="modal"
              style="height: 40px; width: 64px; border-radius: 50px; background: #FF6600;">推文</button>
          </div>
        </div>
      </div>
    </div>
  </form>

  {{!-- reply modal --}}
  <div class="modal fade" id="replyModal" tabindex="-1" aria-labelledby="replyModalLabel" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog" style="max-width: 600px">
      <div class="modal-content" style="border-radius: 15px">
        {{!-- modal header --}}
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
          style="margin: 15px 0px 0px 15px;"></button>
        <hr class="mb-0">
        {{!-- tweet content --}}
        <div class="modal-body">
          <div class="row">
            {{!-- tweeter's avatar --}}
            <div id="tweeter" class="col-2 d-flex flex-column justify-content-start align-items-center">
              <div style="height: 50px;">
                <a href="{{tweet.User.id}}">
                  <img src="{{tweet.User.avatar}}" alt="avatar" style="height: 50px ;width: 50px; border-radius: 50px;">
                </a>
              </div>
              <div class="mx-3 mt-3" style="height: 60%; width: 3px; background: #899095;"></div>
            </div>
            {{!-- tweet's content --}}
            <div class="col-10">
              {{!-- tweeter's info --}}
              <div class="d-flex flex-row align-items-center">
                <p style="font-size: 16px; margin: 0 0;">{{tweet.User.name}}</p>
                <p style="font-size: 14px; margin: 0 8px; color: #6C757D;">@{{tweet.User.account}}．{{relativeTimeFromNow tweet.createdAt}}</p>
              </div>
              {{!-- tweet's description --}}
              <div class="mt-2">
                <p>{{tweet.description}}</p>
              </div>
              <p class="mt-2" style="font-size: 14px; color: #6C757D;">回覆給
                <span style="color:#FF6600;text-decoration: none">@{{tweet.User.account}}</span>
              </p>
            </div>
          </div>
          {{!-- reply content --}}
          <form action="/tweets/{{tweet.id}}/replies" method="POST">
            <div class="row">
              <div class="col-2 d-flex justify-content-center">
                <img src="{{user.avatar}}" alt="avatar" style="height: 50px ;width: 50px; border-radius: 50%;">
              </div>
              <div class="col-9 mb-3 ">
                <textarea type="text" class="form-control me-2" id="reply" name="comment" rows="5" placeholder="推你的回復"
                  style="width: 450px; border: none; background-color: white; word-wrap: break-word;"></textarea>
              </div>
            </div>
            <div class="d-flex flex-row-reverse me-3 mb-3">
              <button type="submit" class="btn btn-primary" id="modal-send-button" data-bs-dismiss="modal"
                style="height: 40px; width: 64px; border-radius: 50px; background: #FF6600;">回覆</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>