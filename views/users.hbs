<div class="w-100">
  <div id="title" class="d-flex w-100 align-items-center border-bottom">
    <a href="/tweets" class="">
      <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="m-3">
        <path
          d="M16 5.99988H3.41399L7.70699 1.70687C8.09699 1.31687 8.09699 0.683875 7.70699 0.292875C7.31699 -0.0981249 6.68399 -0.0971249 6.29299 0.292875L0.292988 6.29288C-0.0970117 6.68288 -0.0970117 7.31588 0.292988 7.70687L6.29299 13.7069C6.48799 13.9019 6.74299 13.9999 6.99999 13.9999C7.25699 13.9999 7.51199 13.9019 7.70699 13.7069C8.09699 13.3169 8.09699 12.6839 7.70699 12.2929L3.41399 7.99988H16C16.553 7.99988 17 7.55288 17 6.99988C17 6.44688 16.553 5.99988 16 5.99988Z"
          fill="black" />
      </svg>
    </a>
    <div id="titleText" class="ms-3 my-2">
      <p class="m-0 fw-bolder">{{thisPageUser.name}}</p>
      <p class="m-0" style="font-size: xx-small;color:#657786">{{thisPageUser.TweetsCount}} 推文</p>
    </div>
  </div>
  {{#if thisPageUser.cover}}
  <div id="cover-and-avatar"
    style="background-image: url({{thisPageUser.cover}});height:200px; background-repeat: no-repeat; background-size:cover;">
    {{else}}
    <div id="cover-and-avatar"
      style="background-color:grey; height:200px; background-repeat: no-repeat; background-size:cover;">
      {{/if}}
      {{#if thisPageUser.avatar}}
      <img src="{{thisPageUser.avatar}}" width="140px" height="140px"
        class="border border-4 border-white rounded-circle ms-2" style="margin-top: 124px;">
      {{else}}
      <img src="https://i.imgur.com/3P9xRqb.jpg" width="140px" height="140px"
        class="border border-4 border-white rounded-circle ms-2" style="margin-top: 124px;">
      {{/if}}
    </div>
    <div class="d-flex m-2 justify-content-end">
      {{#isEqual thisPageUser.id user.id}}
      <button type="submit" class="btn btn-outline-regular rounded-pill" data-bs-toggle="modal"
        data-bs-target="#editProfile" id="edit-profile-modal-button">
        編輯個人資料
      </button>
      <!-- Modal -->
      <div class="modal fade" id="editProfile" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
            <form class="mt-2" enctype="multipart/form-data" action="/users/{{user.id}}?_method=PUT" method="POST">
              <div class="d-flex align-items-center justify-content-between mx-2 mb-2">
                <div class="d-flex  align-items-center">
                  <button type="button" class="btn-close d-flex" data-bs-dismiss="modal" aria-label="Close">
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='#000'>
                      <path
                        d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'
                        fill="#FF6600" />
                    </svg>
                  </button>
                  <p class="m-0 fw-bolder ms-5">編輯個人資料</p>
                </div>
                <button type="submit" class="btn btn-regular rounded-pill">儲存</button>
              </div>
              <div class="d-flex w-100 justify-content-center align-items-center" id="edit-image"
                style="background-image: url({{user.cover}});">
                <div class="d-flex w-100 h-100">
                  <div class="col-4" id="avatar-input-group">
                    <input name="avatarImage" id="avatar-input" type="file" accept="image/gif, image/jpeg, image/png"
                      style="display: none;">
                    <label
                      class="btn rounded-circle border border-3 border-white d-flex justify-content-center align-items-center"
                      id="avatar-label" type="button" for="avatar-input"
                      style="background-image: url({{user.avatar}});">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083H6.438C7.633 3.17 9.722 2 12 2C14.277 2 16.367 3.17 17.562 5.083H19.708C20.972 5.083 22 6.11 22 7.375V19.708C22 20.972 20.972 22 19.708 22ZM4.292 6.583C3.855 6.583 3.5 6.938 3.5 7.375V19.708C3.5 20.145 3.855 20.5 4.292 20.5H19.708C20.145 20.5 20.5 20.145 20.5 19.708V7.375C20.5 6.938 20.145 6.583 19.708 6.583H17.258C16.941 6.633 16.626 6.488 16.476 6.201C15.596 4.536 13.882 3.501 12 3.501C10.117 3.501 8.402 4.536 7.524 6.203C7.364 6.505 7.022 6.663 6.691 6.583H4.293H4.292Z"
                          fill="white" />
                        <path
                          d="M12 8.16699C9.32001 8.16699 7.14001 10.347 7.14001 13.027C7.14001 15.707 9.32001 17.887 12 17.887C14.68 17.887 16.86 15.707 16.86 13.027C16.86 10.347 14.68 8.16699 12 8.16699ZM14 13.75H12.75V15C12.75 15.414 12.414 15.75 12 15.75C11.586 15.75 11.25 15.414 11.25 15V13.75H10C9.58601 13.75 9.25001 13.414 9.25001 13C9.25001 12.586 9.58601 12.25 10 12.25H11.25V11C11.25 10.586 11.586 10.25 12 10.25C12.414 10.25 12.75 10.586 12.75 11V12.25H14C14.414 12.25 14.75 12.586 14.75 13C14.75 13.414 14.414 13.75 14 13.75Z"
                          fill="white" />
                      </svg>
                    </label>
                  </div>
                  <div class="col-4 d-flex  justify-content-center align-items-center" id="cover-input-group">
                    <input name="coverImage" id="cover-input" type="file" accept="image/gif, image/jpeg, image/png"
                      style="display: none;">
                    <input type="text" name="cancelBackground" id="cancelBackground" value="" hidden>
                    <label class="btn me-3" type="button" for="cover-input">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083H6.438C7.633 3.17 9.722 2 12 2C14.277 2 16.367 3.17 17.562 5.083H19.708C20.972 5.083 22 6.11 22 7.375V19.708C22 20.972 20.972 22 19.708 22ZM4.292 6.583C3.855 6.583 3.5 6.938 3.5 7.375V19.708C3.5 20.145 3.855 20.5 4.292 20.5H19.708C20.145 20.5 20.5 20.145 20.5 19.708V7.375C20.5 6.938 20.145 6.583 19.708 6.583H17.258C16.941 6.633 16.626 6.488 16.476 6.201C15.596 4.536 13.882 3.501 12 3.501C10.117 3.501 8.402 4.536 7.524 6.203C7.364 6.505 7.022 6.663 6.691 6.583H4.293H4.292Z"
                          fill="white" />
                        <path
                          d="M12 8.16699C9.32001 8.16699 7.14001 10.347 7.14001 13.027C7.14001 15.707 9.32001 17.887 12 17.887C14.68 17.887 16.86 15.707 16.86 13.027C16.86 10.347 14.68 8.16699 12 8.16699ZM14 13.75H12.75V15C12.75 15.414 12.414 15.75 12 15.75C11.586 15.75 11.25 15.414 11.25 15V13.75H10C9.58601 13.75 9.25001 13.414 9.25001 13C9.25001 12.586 9.58601 12.25 10 12.25H11.25V11C11.25 10.586 11.586 10.25 12 10.25C12.414 10.25 12.75 10.586 12.75 11V12.25H14C14.414 12.25 14.75 12.586 14.75 13C14.75 13.414 14.414 13.75 14 13.75Z"
                          fill="white" />
                      </svg>
                    </label>
                    <label class="btn ms-3">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M13.414 11.9999L19.207 6.20687C19.597 5.81687 19.597 5.18388 19.207 4.79288C18.817 4.40188 18.184 4.40288 17.793 4.79288L12 10.5859L6.207 4.79288C5.817 4.40288 5.184 4.40288 4.793 4.79288C4.402 5.18288 4.403 5.81587 4.793 6.20687L10.586 11.9999L4.793 17.7929C4.403 18.1829 4.403 18.8159 4.793 19.2069C4.988 19.4019 5.243 19.4999 5.5 19.4999C5.757 19.4999 6.012 19.4019 6.207 19.2069L12 13.4139L17.793 19.2069C17.988 19.4019 18.243 19.4999 18.5 19.4999C18.757 19.4999 19.012 19.4019 19.207 19.2069C19.597 18.8169 19.597 18.1839 19.207 17.7929L13.414 11.9999Z"
                          fill="white" />
                      </svg>
                    </label>
                  </div>
                </div>
              </div>
              <div class="form-floating m-3 mt-5" id="name-input-group">
                <input type="text" class="form-control" id="floatingInput" placeholder="" name="name"
                  value="{{user.name}}" maxlength="50" required>
                <label for="floatingInput">名稱</label>
                <p class="text-end" style="color: #657786; height:10px"></p>
              </div>
              <div class="form-floating m-3" id="introduction-input-group">
                <textarea class="form-control" placeholder="Leave a comment here" id="descriptinArea"
                  style="height: 150px; resize:none;" maxlength="140"
                  name="introduction">{{user.introduction}}</textarea>
                <label for="descriptinArea">自我介紹</label>
                <p class="text-end" style="color: #657786; height:10px"></p>
              </div>
            </form>
          </div>
        </div>
      </div>
      {{else}}
      {{#if thisPageUser.isFollowing}}
      <button type="submit" class="btn btn-outline-regular rounded-pill">追隨</button>
      {{else}}
      <button type="submit" class="btn btn-regular rounded-pill">正在追隨</button>
      {{/if}}
      {{/isEqual}}
    </div>
    <div class="mt-4 mx-2" style="line-height: 1;">
      <p class="m-0 fw-bolder">{{thisPageUser.name}}</p>
      <a href="/users/{{thisPageUser.id}}" class="user-link">@{{thisPageUser.account}}</a>
      <p class="mt-3">{{thisPageUser.introduction}}</p>
      <div class="d-flex">
        <div class="d-flex">
          <p>{{thisPageUser.FollowingsCount}}個</p>
          <a href="/users/{{thisPageUser.id}}/followings" style="color:#657786;">跟隨中</a>
        </div>
        <div class="d-flex ms-2">
          <p>{{thisPageUser.FollowersCount}}</p>
          <a href="/users/{{thisPageUser.id}}/followers" style="color:#657786;">跟隨者</a>
        </div>
      </div>
    </div>
    <nav class="nav border-bottom">
      <a class="nav-link active" href="/users/{{thisPageUser.id}}">推文</a>
      <a class="nav-link" href="/users/{{thisPageUser.id}}/replies">推文與回覆</a>
      <a class="nav-link" href="/users/{{thisPageUser.id}}/likes">喜歡的內容</a>
    </nav>
    <div id="tweets">
      {{#each tweets}}
      <div class="border-bottom">
        <div class="container">
          <div class="row">
            <div class="col-auto p-1">
              {{#if this.User.avatar}}
              <img class="rounded-circle" src="{{this.User.avatar}}" style="width: 50px;height: 50px;">
              {{else}}
              <img class="rounded-circle" src="https://i.imgur.com/3P9xRqb.jpg"
                style="max-width: 50px;max-height: 50px;">
              {{/if}}
            </div>
            <div class="col d-flex flex-column p-1">

              <div class="py-1 d-flex align-items-center">
                <strong>{{this.User.name}}</strong>
                <div class="d-flex align-items-center ms-1" style="font-size: x-small; color:#657786">
                  <a href="/users/{{this.User.id}}" class="user-link">@{{this.User.account}} · </a>
                  {{moment this.createdAt}}
                </div>
              </div>

              <div class="py-1">
                <a class="btn" href="/tweets/{{this.id}}">
                  <p class="text-start" style="word-break: break-all;">{{this.description}}</p>
                </a>
              </div>

              <div class="d-flex py-1 align-items-center">

                <div class="me-1">
                    <button class="btn d-flex p-0 align-items-center" data-bs-toggle="modal"
                      data-bs-target="#post-reply-modal" data-id="{{this.id}}">
                      <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M7.77881 0.40127L5.18631 0.39502H5.18506C2.45131 0.39502 0.310059 2.53689 0.310059 5.27127C0.310059 7.83252 2.30131 9.77502 4.97568 9.87752V12.27C4.97568 12.3375 5.00318 12.4488 5.05068 12.5219C5.13943 12.6625 5.29068 12.7388 5.44568 12.7388C5.53193 12.7388 5.61881 12.715 5.69693 12.665C5.86193 12.56 9.74256 10.0775 10.7519 9.22377C11.9407 8.21752 12.6519 6.74252 12.6538 5.27877V5.26814C12.6501 2.53877 10.5101 0.401269 7.77881 0.400644V0.40127ZM10.1457 8.50877C9.43693 9.10877 7.10693 10.6369 5.91318 11.4106V9.41877C5.91318 9.16002 5.70381 8.95002 5.44443 8.95002H5.19693C2.90943 8.95002 1.24818 7.40252 1.24818 5.27127C1.24818 3.06252 2.97818 1.33252 5.18568 1.33252L7.77756 1.33877H7.77881C9.98631 1.33877 11.7163 3.06752 11.7176 5.27377C11.7157 6.46752 11.1288 7.67627 10.1463 8.50877H10.1457Z"
                          fill="#657786" />
                      </svg>
                      <p class="my-0 ms-1" style="color: #657786;">{{this.RepliesCount}}</p>
                    </button>
                </div>

                <div class="ms-5">
                  {{#if this.isLiked }}
                  <form action="/like/{{this.id}}?_method=DELETE" method="POST" class=" d-flex align-items-center">
                    <button type="submit" class="btn d-flex align-items-center" style="color:#E0245E" id="likeHeart">
                      <svg width="22" height="20" viewBox="0 0 22 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M11 19.6381H10.986C8.403 19.5901 0.949997 12.8561 0.949997 6.47812C0.949997 3.41412 3.475 0.724121 6.353 0.724121C8.643 0.724121 10.183 2.30412 10.999 3.45412C11.813 2.30612 13.353 0.724121 15.644 0.724121C18.524 0.724121 21.048 3.41412 21.048 6.47912C21.048 12.8551 13.594 19.5891 11.011 19.6361H11V19.6381Z"
                          fill="#E0245E" />
                      </svg>

                      <p class="mb-0 ms-1">{{this.LikedUsersCount}}</p>
                    </button>
                  </form>
                  {{else}}
                  <form action="/like/{{this.id}}" method="POST" class=" d-flex align-items-center ms-1">
                    <button type="submit" class="btn d-flex align-items-center" style="color:#657786" id="likeHeart">
                      <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M6.5 12.5236H6.49125C4.87687 12.4936 0.21875 8.28489 0.21875 4.29864C0.21875 2.38364 1.79687 0.702393 3.59562 0.702393C5.02687 0.702393 5.98937 1.68989 6.49937 2.40864C7.00812 1.69114 7.97062 0.702393 9.4025 0.702393C11.2025 0.702393 12.78 2.38364 12.78 4.29927C12.78 8.28427 8.12125 12.493 6.50687 12.5224H6.5V12.5236ZM3.59625 1.64052C2.29625 1.64052 1.15687 2.88302 1.15687 4.29989C1.15687 7.88739 5.55312 11.5474 6.50062 11.5861C7.44937 11.5474 11.8444 7.88802 11.8444 4.29989C11.8444 2.88302 10.705 1.64052 9.405 1.64052C7.825 1.64052 6.9425 3.47552 6.935 3.49364C6.79125 3.84489 6.2125 3.84489 6.06812 3.49364C6.05937 3.47489 5.1775 1.64052 3.59687 1.64052H3.59625Z"
                          fill="#657786" />
                      </svg>


                      <p class="mb-0 ms-1">{{this.LikedUsersCount}}</p>
                    </button>
                  </form>
                  {{/if}}
                </div>

                <div class="d-flex align-items-center">
                  {{this.LikedCount}}
                </div>

              </div>

            </div>
          </div>
        </div>
      </div>
      {{/each}}
    </div>
  </div>
  <script src="/javascripts/userPage.js"></script>