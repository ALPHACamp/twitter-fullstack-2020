<div class="container">
  <div class="wrapper d-flex align-items-stretch">
    <nav id="sidebar">
      <div>
        {{> leftColumn}}
      </div>
    </nav>

    {{!-- {{> addTweet}} --}}

    <div class="center-content d-flex" id="tweet-content">
      <div class="head justify-content-between ">
        <a href="javascript:history.back()" style="color: black;">
          <div class="head-content d-flex">
            <i class="fas fa-arrow-left ml-2 mt-3"></i>
            <div class="head-content-user-info">
              <h5 class="tweet-title-user">{{users.name}}</h5>
              <div class="title-description-user">{{users.Tweets.length}} tweets</div>
            </div>
          </div>
        </a>
        <div class="user-cover" style="top: -30px; background: #C4C4C4; width: 100%; height: 200px;">
          <img {{#if users.cover}}src="{{users.cover}}" {{/if}}>
        </div>
        <div class="tweet-content-box">
          <div class="user-info-top">
            <a href="/users/{{users.id}}/tweets">
              <img class="ml-2 mt-2" {{#if users.avatar}}src={{users.avatar}}{{/if}}
                style="top: -30px;background: #C4C4C4;border-radius: 100%;">
            </a>
          </div>
          <div class="tweet-content-right">
            <div class="tweet-content-username">
              <a href="/users/{{users.id}}/tweets" class="user-name">{{users.name}}</a>
              <span class="user-account">{{users.account}}</span>
            </div>
            <div class="tweet-content-info">
              <span class="tweet-content-description">{{users.introduction}}</span><br>
            </div>
            <div class="user-followships">
              <a href="/users/{{users.id}}/followings">{{users.Followings.length}}</a>
              <span>followings&nbsp;&nbsp;</span>
              <a href="/users/{{users.id}}/followers">{{users.Followers.length}}</a>
              <span>followers</span>
            </div>
          </div>

          <div class="user-info-top">
            {{#ifCond users.id currentUserId}}
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editUser">
              編輯個人資料
            </button>
            {{else}}
            {{#if users.isFollowed}}
            <a href="mailto:{{users.email}}"><i class="far fa-envelope"></i></a>
            <i class="far fa-bell"></i>
            <form action="/followships/{{users.id}}?_method=DELETE" method="POST" style="display: inline-block;">
              <button type="submit" class="btn btn-primary">following</button>
            </form>
            {{else}}
            <form action="/followships" method="POST" style="display: inline-block;">
              <button type="submit" class="btn btn-primary" name="id" value="{{users.id}}">follow</button>
            </form>
            {{/if}}
            {{/ifCond}}
          </div>


        </div>
        <div class="user-selection-bar">
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link active" href="/users/{{users.id}}/tweets">推文</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/users/{{users.id}}/replies">推文與回應</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/users/{{users.id}}/likes">喜歡的內容</a>
            </li>
          </ul>
        </div>

        <div class="tweet-all">
          {{#each users.Tweets}}
          <div class="tweet-content-box" onclick="location.href='/tweets/{{this.id}}'">
            <div class="tweet-content-left">
              <a href="/users/{{../users.id}}/tweets">
                <img class="ml-2 mt-2" {{#if ../users.avatar}}src={{../users.avatar}}{{/if}}
                  style="background: #C4C4C4;border-radius: 100%; width: 50px; height: 50px">
              </a>
            </div>
            <div class="tweet-content-right">
              <div class="tweet-content-username">
                <a href="/users/{{../users.id}}/tweets" class="user-name">{{../users.name}}</a>
                <span class="user-account">{{../users.account}}．{{moment this.createdAt}}</span>
              </div>
              <div class="tweet-content-info">
                <span class="tweet-content-description">{{this.description}}</span><br>
              </div>
              <div class="tweet-content-bottom">
                {{!-- reply icon --}}
                <button type="button" class="btn tweet-reply-link mr-3">
                  <i class="fas fa-reply mr-1" aria-hidden="true"></i>{{this.Replies.length}}
                </button>
                {{!-- like/unlike icon --}}
                {{#if isLiked}}
                <form action="/tweets/{{this.id}}/unlike?_method=DELETE" method="POST">
                  <button type="submit" class="btn tweet-like-link">
                    <i class="fas fa-heart mr-1"></i>{{this.LikedUsers.length}}
                  </button>
                </form>
                {{else}}
                <form action="/tweets/{{this.id}}/like" method="POST">
                  <button type="submit" class="btn tweet-like-link">
                    <i class="far fa-heart mr-1"></i>{{this.LikedUsers.length}}
                  </button>
                </form>
                {{/if}}
              </div>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </div>

    <div class="right-content">
      {{> rightColumn}}
    </div>
  </div>
</div>

<!-- edit user info modal 範例 -->
<div class="modal fade" id="editUser" tabindex="-1" role="dialog" aria-labelledby="editUser" aria-hidden="true"
  data-backdrop="true">
  <form action="/users/{{users.id}}/edit?_method=PUT" method="post" enctype="multipart/form-data">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header m-2 p-2">
          <div class="row" style="width: 100%;">
            <div class="col-1 text-left">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span style="color: #FF6600;" aria-hidden="true">x</span>
              </button>
            </div>
            <div class="col-8">
              <h5 class="modal-title "><strong>編輯個人資料</strong></h5>
            </div>
            <div class="col-3 text-right">
              <button type="submit" class="btn rounded-pill" style="background-color: #FF6600; color:white">
                儲存
              </button>
            </div>
          </div>
        </div>
        <div class="modal-body m-1 p-1">
          {{!-- cover&avatar --}}
          <div class="img-wrapper d-flex flex-column flex-nowrap" style="position:relative;">
            <label for="cover" class="btn btn-light">
              <input type="file" id="cover" name="cover" class="form-control-file" style="display: none;">
              <i class="fa fa-camera-retro" aria-hidden="true"></i>上傳背景圖
              <img src="{{users.cover}}" class="card-img-top" alt="background" width="100%" height="200px"
                style="object-fit: cover;">
            </label>
            <label for="avatar" class="btn btn-light">
              <input type="file" id="avatar" name="avatar" class="form-control-file" style="display: none;">
              <i class="fa fa-camera-retro" aria-hidden="true"></i>上傳頭貼
              <img src="{{users.avatar}}" class="rounded-circle mb-5" alt="avatar" width="140" height="140"
                style="border: 4px solid #FFFFFF; position:absolute; top:60%; left:14px;">
            </label>
          </div>
          <div class="d-flex flex-column mt-5">
            <div class="p-2 mt-3">
              <span class="mt-3">名稱</span><br>
              <textarea type="text" name="name" id="name" cols="55" rows="1" class="border-bottom form-control"
                style="resize:none;outline:none;wrap:off;overflow:auto;border-color:transparent">{{users.name}}</textarea>
            </div>
            <div class="p-2 mt-3">
              <span class="mt-3">自我介紹</span><br>
              <textarea type="text" name="introduction" id="introduction" cols="55" rows="4"
                class="border-bottom form-control"
                style="resize:none;outline:none;wrap:off;overflow:auto;border-color:transparent">{{users.introduction}}</textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>