{{#if userSettingsPage}}
<div class="user-template-setting">
  {{else}}
  <div class="user-template">
    {{/if}}
    <div class="leftside">
      <div class="navigation">
        <i class='ac-icon'></i>
        <a class="active" href='/tweets'><i class='home active'></i>首頁</a>
        <a class="" href="/users/{{loginUser.id}}/tweets"><i class='info'></i>個人資料</a>
        <a class="" href='/users/{{loginUser.id}}/settings'><i class='setting'></i>設定</a>
        <button type="button" class="btn-fill" id="posting"
          onclick="document.querySelector('#modal-post').classList.remove('d-none');">推文</button>
      </div>

      <div class="footer">
        <a href="/signout"><i class='logout'></i>登出</a>
      </div>
    </div>

    <div class="main">
      {{!-- USER PARTIALS --}}
      {{#if indexPage}}{{> tweets}}{{/if}}
      {{#if userTweetsPage}}{{> profileTweets}}{{/if}}
      {{#if userRepliesPage}}{{> profileReplies}}{{/if}}
      {{#if userLikesPage}}{{> profileLikes}}{{/if}}
      {{#if userFollowersPage}}{{> profileFollower}}{{/if}}
      {{#if userFollowingsPage}}{{> profileFollowing}}{{/if}}
      {{#if userSettingsPage}}{{> profileSettings}}{{/if}}

    </div>
    {{#unless userSettingsPage}}
    <div class="rightside">

      <div class="popular">
        <span>Popular</span>

        {{#each pops}}
        <div class="wrap">
          <a href="/users/{{this.id}}/tweets"><img class="thumbnail" {{#if this.avatar}} src="{{this.avatar}}"
              alt="{{this.avatar}} avatar" {{/if}}>
            <span>
              <span class="name">{{this.name}}</span>
              <span class="at-name ellipsis">{{this.account}}</span>
            </span>
          </a>
          {{#if this.isFollowing}}
          <form action="/followships/{{this.id}}?_method=DELETE" method="POST">
            <button type="submit">正在追蹤</button>
          </form>
          {{!-- <a class="btn-fill sm" href="#followship">正在追蹤</a> --}}
          {{else}}
          <form action="/followships" method="POST">
            <input type="hidden" name="id" value="{{this.id}}">
            <button type="submit">跟隨</button>
          </form>
          {{!-- <a class="btn-outline sm" href="/followships/{{this.id}}">跟隨</a> --}}
          {{/if}}
        </div>
        {{/each}}

      </div>

    </div>
    {{/unless}}

  </div>

  {{!-- posting modal --}}
  <div class="modal d-none" id="modal-post">
    <div class="mask">
      <div class="dialog">
        <div class="dialog-header">
          <a class='close'><i class='X-orange close'></i></a>
        </div>
        <div class="postarea">
          <a>
            <img class="thumbnail" src="/icons/avatar.svg" alt="">
          </a>
          <form action="/tweets" method="post" novalidate id="modal-post-form">
            <input type="hidden" name="userId" value="{{loginUser.id}}">
            <textarea name="description" maxlength="140" cols="48" rows="6" placeholder="有什麼新鮮事？" required
              id="modal-post-form-textarea"></textarea>
            <div class="foot">
              <span class="d-none">內容不可空白</span>
              <button type="summit" class="btn-fill">推文</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  {{!-- replying modal --}}
  <div class="modal d-none" id="modal-reply">
    <div class="mask">
      <div class="dialog">
        <div class="dialog-header">
          <a class="close"><i class='X-orange close'></i></a>
        </div>
        <div class="replyarea">

          <div class="tweet">
            <a>
              <img class="thumbnail" src="/icons/avatar.svg" alt="">
            </a>
            <div class="tweetcontent">
              <a class="tweetuser">
                <span class="name ellipsis">Loading...</span>
                <span class="at-name ellipsis">@Loading...</span>
                <span class="timer ellipsis">Loading...</span>
              </a>
              <span class="tweetdescription" id="modal-reply-content">
                Loading . . .
              </span>
              <span class="replyto">回覆給
                <span class="at-name">@Loading...</span>
              </span>
            </div>

          </div>
        </div>

        <div class="postarea">
          <a>
            <img class="thumbnail" src="/icons/avatar.svg" alt="">
          </a>
          <form action="/notyet" method="post" id="modal-reply-form" novalidate>
            <input type="hidden" name="userId" value="{{user.id}}">
            <textarea name="description" maxlength="140" cols="48" rows="2" placeholder="推你的回覆"
              id="modal-reply-form-textarea" required></textarea>
            <div class="foot">
              <span class="d-none">內容不可空白</span>
              <button type="summit" class="btn-fill">回覆</button>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>

  {{!-- editing modal --}}
  {{#ifCond loginUser.id user.id}}
  <div class="modal d-none" id="modal-edit">
    <div class="mask">
      <div class="dialog">
        <div class="dialog-header">
          <a class="close"><i class='X-orange close'></i></a>
          <span>編輯個人資料</span>
        </div>

        <form method="POST" action="/???" enctype="multipart/form-data">
          <div class="edit-cover">
            <img src="/icons/cover.svg" alt="" id="modal-edit-cover">
            <input type="file" class="d-none" id="cover" name="cover"
              value="{{#if User.cover}}{{User.cover}}{{else}}/icons/cover.svg{{/if}}"
              onchange="document.querySelector('#modal-edit-cover').src=this.value">
            <a>
              <input type="button" class="camera" onclick="document.querySelector('#cover').click();">
            </a>
            <a>
              <input type="button" class="X-white"
                onclick="document.querySelector('#modal-edit-cover').src='/icons/cover.svg'">
            </a>
          </div>

          <div class="edit-avatar">
            <img src="/icons/avatar-lg.svg" alt="" id="modal-edit-avatar">
            <input type="file" class="d-none" id="avatar" name="avatar"
              value="{{#if User.avatar}}{{User.avatar}}{{else}}/icons/avatar-lg.svg{{/if}}"
              onchange="document.querySelector('#modal-edit-avatar').src=this.value">
            <a>
              <input type="button" class="camera" onclick="document.querySelector('#avatar').click();">
            </a>
          </div>

          <div class="for-name edit-text">
            <div class="text-label">
              <label for="name">
                名稱
              </label>
            </div>
            <div class="edit-form">
              <input type="text" name="name" class="edit-name" maxlength="50" required
                onkeyup=";document.querySelector('#name-counter').textContent=`${this.value.length}/50`;"
                value="{{User.name}}">
            </div>
            <div class="counter" id="name-counter">{{#if User.name}}{{User.name.length}}{{else}}0{{/if}}/50</div>
          </div>

          <div class="for-intro edit-text">
            <div class="text-label">
              <label for="introduction" class="text-label">
                自我介紹
              </label>
            </div>
            <div class="edit-form">
              <textarea name="introduction" class="edit-introduction" maxlength="160"
                onkeyup="document.querySelector('#introduction-counter').textContent=`${this.value.length}/160`;">{{User.introduction}}</textarea>
            </div>
            <div class="counter" id="introduction-counter">{{#if
              User.introduction}}{{User.introduction.length}}{{else}}0{{/if}}/160</div>
          </div>


          <button class="btn-fill form" type="submit">儲存</button>
        </form>
      </div>

    </div>
  </div>
  {{/ifCond}}

</div>