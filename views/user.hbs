{{#ifCond partial "profileSettings"}}
<div class="user-template-setting">
  {{else}}
  <div class="user-template">
    {{/ifCond}}
    <div class="leftside">
      <div class="navigation">
        <i class='ac-icon'></i>

        {{#ifCond partial "tweets"}}
        <a class="active" href='/tweets'><i class='home active'></i>首頁</a>
        {{else}}
        {{#ifCond partial "tweet"}}
        <a class="active" href='/tweets'><i class='home active'></i>首頁</a>
        {{else}}
        <a class="" href='/tweets'><i class='home'></i>首頁</a>
        {{/ifCond}}
        {{/ifCond}}


        {{#ifCond loginUser.id user.id}}
        <a class="active" href="/users/{{loginUser.id}}/tweets"><i class='info active'></i>個人資料</a>
        {{else}}
        <a class="" href="/users/{{loginUser.id}}/tweets"><i class='info'></i>個人資料</a>
        {{/ifCond}}

        {{#ifCond partial "profileSettings"}}
        <a class="active" href='/users/{{loginUser.id}}/settings'><i class='setting active'></i>設定</a>
        {{else}}
        <a class="" href='/users/{{loginUser.id}}/settings'><i class='setting'></i>設定</a>
        {{/ifCond}}

        <button type="button" class="btn-fill" id="posting"
          onclick="document.querySelector('#modal-post').classList.remove('d-none');">推文</button>
      </div>

      <div class="footer">
        <a href="/signout"><i class='logout'></i>登出</a>
      </div>
    </div>

    <div class="main">
      {{!-- USER PARTIALS --}}
      {{> (lookup . "partial") }}
    </div>

    {{#ifCond partial "userSettingsPage"}}{{else}}
    <div class="rightside">

      <div class="popular">
        <span>Popular</span>

        {{#each pops}}
        <div class="wrap">
          <a href="/users/{{this.id}}/tweets"><img class="thumbnail" src="{{this.avatar}}" alt="{{this.name}} avatar">
            <span>
              <span class="name">{{this.name}}</span>
              <span class="at-name ellipsis">@{{this.account}}</span>
            </span>
          </a>
          {{#if this.isFollowing}}
          <form action="/followships/{{this.id}}?_method=DELETE" method="POST">
            <button type="submit" class="btn-fill sm">正在追蹤</button>
          </form>
          {{else}}
          <form action="/followships" method="POST">
            <input type="hidden" name="id" value="{{this.id}}">
            <button type="submit" class="btn-outline sm">跟隨</button>
          </form>
          {{/if}}
        </div>
        {{/each}}

      </div>

    </div>
    {{/ifCond}}

  </div>

  {{!-- posting modal --}}
  <div class="modal d-none" id="modal-post">
    <div class="mask">
      <div class="dialog">
        <div class="dialog-header">
          <a class='close'><i class='X-orange close'></i></a>
        </div>
        <div class="postarea">
          <a>
            <img class="thumbnail" src="{{loginUser.avatar}}" alt="">
          </a>
          <form action="/tweets" method="post" novalidate id="modal-post-form">
            <input type="hidden" name="userId" value="{{loginUser.id}}">
            <textarea name="description" maxlength="140" cols="48" rows="6" placeholder="有什麼新鮮事？" required
              id="modal-post-form-textarea"></textarea>
            <div class="foot">
              <span class="d-none">內容不可空白</span>
              <button type="summit" class="btn-fill">推文</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  {{!-- replying modal --}}
  <div class="modal d-none" id="modal-reply">
    {{!-- layout.js --}}
  </div>

  {{!-- editing modal --}}
  {{#ifCond loginUser.id user.id}}
  <div class="modal d-none" id="modal-edit">
    <div class="mask">
      <div class="dialog">
        <div class="dialog-header">
          <a class="close"><i class='X-orange close'></i></a>
          <span>編輯個人資料</span>
        </div>

        <form method="POST" action="/???" enctype="multipart/form-data">
          <div class="edit-cover">
            <img src="/icons/cover.svg" alt="" id="modal-edit-cover">
            <input type="file" class="d-none" id="cover" name="cover"
              value="{{#if User.cover}}{{User.cover}}{{else}}/icons/cover.svg{{/if}}"
              onchange="document.querySelector('#modal-edit-cover').src=window.URL.createObjectURL(this.files[0]);">
            <a>
              <input type="button" class="camera" onclick="document.querySelector('#cover').click();">
            </a>
            <a>
              <input type="button" class="X-white"
                onclick="document.querySelector('#modal-edit-cover').src='/icons/cover.svg'">
            </a>
          </div>

          <div class="edit-avatar">
            <img src="/icons/avatar-lg.svg" alt="" id="modal-edit-avatar">
            <input type="file" class="d-none" id="avatar" name="avatar"
              value="{{#if User.avatar}}{{User.avatar}}{{else}}/icons/avatar-lg.svg{{/if}}"
              onchange="document.querySelector('#modal-edit-avatar').src=window.URL.createObjectURL(this.files[0]);">
            <a>
              <input type="button" class="camera" onclick="document.querySelector('#avatar').click();">
            </a>
          </div>

          <div class="for-name edit-text">
            <div class="text-label">
              <label for="name">
                名稱
              </label>
            </div>
            <div class="edit-form">
              <input type="text" name="name" class="edit-name" maxlength="50" required
                onkeyup=";document.querySelector('#name-counter').textContent=`${this.value.length}/50`;"
                value="{{User.name}}">
            </div>
            <div class="counter" id="name-counter">{{#if User.name}}{{User.name.length}}{{else}}0{{/if}}/50</div>
          </div>

          <div class="for-intro edit-text">
            <div class="text-label">
              <label for="introduction" class="text-label">
                自我介紹
              </label>
            </div>
            <div class="edit-form">
              <textarea name="introduction" class="edit-introduction" maxlength="160"
                onkeyup="document.querySelector('#introduction-counter').textContent=`${this.value.length}/160`;">{{User.introduction}}</textarea>
            </div>
            <div class="counter" id="introduction-counter">{{#if
              User.introduction}}{{User.introduction.length}}{{else}}0{{/if}}/160</div>
          </div>


          <button class="btn-fill form" type="submit">儲存</button>
        </form>
      </div>

    </div>
  </div>
  {{/ifCond}}

</div>